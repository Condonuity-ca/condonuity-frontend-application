<div id="profile" class="page-layout simple">
  <div id="about" class="p-8" fxLayout="row wrap">

    <div class="about-content" fxLayout="column" fxFlex="100" fxFlex.gt-sm="100" fxFlex.gt-md="100">
      <div class="" fxLayout="row" fxLayoutAlign="space-between center" class="" [ngClass.lg]="'mt-32 mx-24'"
        [ngClass.md]="'mt-32 mx-24'" [ngClass.sm]="'mt-32 mx-24'" [ngClass.xs]="'mt-16 mx-0'">
        <div class="">
          <div class="h2 condo-gray-text">Filter External Messages By Condo</div>
        </div>
      </div>

      <form fxLayout="column" fxLayoutAlign="start" fxFlex.lg="1 0 auto" fxFlex.md="1 0 auto" fxFlex.sm="1 0 auto"
        fxFlex.xs="1 0 auto" class="mb-32" [ngClass.lg]="'mx-24'" [ngClass.md]="'mx-24'" [ngClass.sm]="'mx-24'"
        [ngClass.xs]="'mx-0'" [formGroup]="condoUserform">
        <div class="" fxLayout.lg="row" fxLayout.md="row" fxLayout.sm="column" fxLayout.xs="column"
          fxLayoutAlign.sm="start" fxLayoutAlign.xs="start" fxLayoutAlign="space-between center"
          class="mat-card mat-elevation-z  pt-32 ">
          <div class="pr-4" fxFlex.lg="100" fxFlex.md="100" fxFlex.sm="100" fxFlex.xs="100" fxLayout.lg="row"
            fxLayout.md="row" fxLayout.sm="column" fxLayout.xs="column" [ngClass.lg]="'mx-24 '" [ngClass.md]="'mx-24'"
            [ngClass.sm]="'ml-32 mr-12'" [ngClass.xs]="'px-12 mr-12'">

            <div class="pr-16 mt-16 condo-gray-text" fxLayout.lg="row" fxLayout.md="row" fxLayout.sm="row"
              fxLayout.xs="column" fxFlex="70" fxLayoutAlign.lg="start top" fxLayoutAlign.md="start top"
              fxLayoutAlign.sm="start top" fxLayoutAlign.xs="start top" formGroupName="contractType">
              <mat-label class="secondary-text font-weight-600 pt-4" fxFlex.lg="35" fxFlex.md="35" fxFlex.sm="35"
                fxFlex.xs="100" [ngClass.xs]="'mb-16'">
                SEARCH CONDO BY: </mat-label>
              <mat-radio-group aria-label="Select an option" fxFlex.lg="65" fxFlex.md="65" fxFlex.sm="65"
                fxFlex.xs="100" fxLayout.xs="column">
                <mat-radio-button [checked]="condoSearchType == 1" appearance="outline" class="pr-16" fxFlex="50"
                  fxFlex.xs="100" [ngClass.xs]="'mb-16'" value=1 (change)="searchTypeChanged($event.value)">Condo Name
                </mat-radio-button>
                <mat-radio-button [checked]="condoSearchType == 2" appearance="outline" class="pr-16" fxFlex="50"
                  fxFlex.xs="100" [ngClass.xs]="'mb-16'" value=2 (change)="searchTypeChanged($event.value)">Corporation
                  #
                </mat-radio-button>
              </mat-radio-group>
            </div>


            <mat-form-field *ngIf="condoSearchType == 1" appearance="outline" class="" [ngClass.lg]="'pr-16'"
              [ngClass.md]="'pr-16'" [ngClass.sm]="'pr-16'" [ngClass.xs]="'pr-0'" fxFlex.lg="30" fxFlex.md="40"
              fxFlex.sm="50" fxFlex.xs="100">
              <mat-label>Condo Name</mat-label>

              <mat-chip-list maxLength="1" #cityChipList aria-label="City Selection" formControlName="cityChips">
                <mat-chip *ngFor="let condo of selectedCondos" [selectable]="selectable" [removable]="removable"
                  (removed)="removeCondo(condo)">
                  {{condo.organisationName}}
                  <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                </mat-chip>
                <input [disabled]="isInputDisabled" placeholder="Condo Name" #condoInput [formControl]="condoCtrl"
                  formControlName="condos" [matAutocomplete]="cityAuto" [matChipInputFor]="cityChipList"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes" [matChipInputAddOnBlur]="addOnBlur">
              </mat-chip-list>
              <mat-autocomplete #cityAuto="matAutocomplete" (optionSelected)="selectCondo($event)">
                <mat-option *ngFor="let condo of filteredCondos | async" [value]="condo">
                  {{condo.organisationName}}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>

            <mat-form-field *ngIf="condoSearchType == 2" appearance="outline" class="" [ngClass.lg]="'pr-16'"
              [ngClass.md]="'pr-16'" [ngClass.sm]="'pr-16'" [ngClass.xs]="'pr-0'" fxFlex.lg="30" fxFlex.md="40"
              fxFlex.sm="50" fxFlex.xs="100">
              <mat-label>Corp. Number#</mat-label>

              <mat-chip-list maxLength="1" #cityChipList aria-label="City Selection" formControlName="cityChips">
                <mat-chip *ngFor="let condo of selectedCondos" [selectable]="selectable" [removable]="removable"
                  (removed)="removeCondo(condo)">
                  {{condo.corporateNumber}}
                  <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                </mat-chip>
                <input [disabled]="isInputDisabled" placeholder="Corporate Number" #condoInput [formControl]="condoCtrl"
                  formControlName="condos" [matAutocomplete]="cityAuto" [matChipInputFor]="cityChipList"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes" [matChipInputAddOnBlur]="addOnBlur">
              </mat-chip-list>
              <mat-autocomplete #cityAuto="matAutocomplete" (optionSelected)="selectCondo($event)">
                <mat-option *ngFor="let condo of filteredCondos | async" [value]="condo">
                  {{condo.corporateNumber}}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>

          </div>
        </div>
      </form>

      <!-- <form fxLayout="column" fxLayoutAlign="start" fxFlex.lg="1 0 auto" fxFlex.md="1 0 auto" fxFlex.sm="1 0 auto"
        fxFlex.xs="1 0 auto" class="mb-32" [ngClass.lg]="'mx-24'" [ngClass.md]="'mx-24'" [ngClass.sm]="'mx-24'"
        [ngClass.xs]="'mx-0'" [formGroup]="condoUserform">
        <div class="" fxLayout.lg="row" fxLayout.md="row" fxLayout.sm="column" fxLayout.xs="column"
          fxLayoutAlign.sm="start" fxLayoutAlign.xs="start" fxLayoutAlign="space-between center"
          class="mat-card mat-elevation-z  pt-32 mt-16">
          <div class="pr-4" fxFlex.lg="100" fxFlex.md="100" fxFlex.sm="100" fxFlex.xs="100" fxLayout.lg="row"
            fxLayout.md="row" fxLayout.sm="column" fxLayout.xs="column" [ngClass.lg]="'mx-24 '" [ngClass.md]="'mx-24'"
            [ngClass.sm]="'mx-24'" [ngClass.xs]="'px-12 mr-12'">

            <mat-form-field appearance="outline" class="" [ngClass.lg]="'pr-16'" [ngClass.md]="'pr-16'"
              [ngClass.sm]="'pr-16'" [ngClass.xs]="'pr-0'" fxFlex.lg="40" fxFlex.md="40" fxFlex.sm="50" fxFlex.xs="40">
              <mat-label>Search Condo</mat-label>

              <mat-chip-list maxLength="1" #cityChipList aria-label="City Selection" formControlName="cityChips">
                <mat-chip *ngFor="let condo of selectedCondos" [selectable]="selectable" [removable]="removable"
                  (removed)="removeCondo(condo)">
                  {{condo.organisationName}}
                  <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                </mat-chip>
                <input [disabled]="isInputDisabled" placeholder="Condo Name" #condoInput [formControl]="condoCtrl"
                  formControlName="condos" [matAutocomplete]="cityAuto" [matChipInputFor]="cityChipList"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes" [matChipInputAddOnBlur]="addOnBlur">
              </mat-chip-list>
              <mat-autocomplete #cityAuto="matAutocomplete" (optionSelected)="selectCondo($event)">
                <mat-option *ngFor="let condo of filteredCondos | async" [value]="condo">
                  {{condo.organisationName}}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>

          </div>
        </div>
      </form> -->

      <div class="mt-8">
        <div fxLayout="column" id="timeline" class="pb-32 mx-24" [ngClass.lg]="'py-16 px-8'" [ngClass.md]="'p-32'"
          [ngClass.sm]="'p-24'" [ngClass.xs]="'p-16'">

          <div fxLayout="row" fxLayout.sm="column" fxLayout.xs="column" fxLayoutAlign="space-between center"
            fxLayoutAlign.sm="start" fxLayoutAlign.xs="start" class="mt-16 mx-24">
            <div class="" [ngClass.sm]="'mb-16'" [ngClass.xs]="'mb-16'">
              <div class="h2 condo-gray-text">Sort by </div>
            </div>
            <div fxLayout="row" fxLayout.xs="column">
              <mat-button-toggle-group value="nearest" fxLayout.xs="row">
                <div class="condo-sorting" fxLayout.xs="column">
                  <mat-button-toggle value="nearest" class="mat-stroked-button mat-primary mr-12 active"
                    [ngClass.xs]="'mb-16'" (click)="sortMessages(1)">
                    SUBJECT
                  </mat-button-toggle>
                  <mat-button-toggle value="rating" class="mat-stroked-button mat-primary mr-12" [ngClass.xs]="'mb-16'"
                    (click)="sortMessages(2)">
                    USER
                  </mat-button-toggle>
                  <mat-button-toggle value="alphabetical" class="mat-stroked-button mat-primary" [ngClass.xs]="'mb-16'"
                    (click)="sortMessages(3)">
                    ALPHABETICAL
                  </mat-button-toggle>
                </div>
              </mat-button-toggle-group>
            </div>
          </div>


          <div *ngFor="let message of pageOfItems" fxLayout="column">

            <div fxFlex="70" style="" class="mat-card mat-elevation-z  pb-24 pt-0 b-r-4 shadow" fxFlex.sm="100"
              fxFlex.xs="100" [ngClass.lg]="'mx-24 mt-24'" [ngClass.md]="'mx-24 mt-24'" [ngClass.sm]="'mb-4 mx-4 mt-24'"
              [ngClass.xs]="'mx-4 mt-20'">

              <div class="pt-8 pb-8 px-8 px-24" fxLayout="row wrap" fxLayoutAlign="" style="background:#f0f0f0"><span
                  class="condo-gray-text mr-12">To: </span>
                <span class="condo-gray-text recipients mr-8"
                  *ngFor="let org of message.targetOrganisations;let i = index">{{org.organisationName}} </span>

                <!-- <div style="" fxLayout="row wrap" fxLayoutAlign="end end" class="mt-16">
                  <div class="h5 font-weight-600 cursor mt-12 condo-green-text" [ngClass.xs]="'mt-4 text-center'">
                    APPROVED</div>
                </div> -->

              </div>



              <div class="px-24" fxLayout="column">
                <div class="mat-card mat-elevation-z" [ngClass.lg]="'mr-0'" [ngClass.md]="'mr-24'"
                  [ngClass.xs]="'mr-0'">

                  <div class="" fxLayout="row" fxLayout.sm="row wrap" fxLayoutAlign="start center" fxLayout.xs="column">



                    <div class="" [ngClass.lg]="'w-80 h-80'" [ngClass.md]="'w-80 h-80'" [ngClass.sm]="'w-60 h-60'"
                      [ngClass.xs]="'mb-12 w-60 h-60'">
                      <img *ngIf="message.fromUser.profileImageURL" [src]="message.fromUser.profileImageURL"
                        class="border-radius-100" [ngClass.sm]="'mt-16 ml-20'" [ngClass.xs]="'text-center mt-16'"
                        src="assets/images/no-pic.jpg">
                      <img *ngIf="message.fromUser.profileImageURL == ''" class="border-radius-100"
                        [ngClass.sm]="'mt-16 ml-20'" [ngClass.xs]="'text-center mt-16'"
                        src="assets/images/no-pic.jpg">
                    </div>
                    <div class="pr-16 ml-16" fxLayout="row" fxFlex="100" fxLayoutAlign="start center"
                      fxLayout.xs="column" (click)="viewMessageDetails(message)">
                      <div class="" fxFlex="100" fxFlex.xs="100">

                        <div class="" fxLayout="row" fxLayout.sm="column wrap" fxLayout.xs="column wrap"
                          fxLayoutAlign="space-between end" fxLayoutAlign.sm="start start"
                          fxLayoutAlign.xs="space-between center" [ngClass.sm]="'mt-24'" [ngClass.xs]="'mt-20'">
                          <div class="h3 font-weight-600" fxLayout="column">{{message.threadSubject}}</div>
                          <div class="condo-gray-text mt-16" fxLayout="column" fxLayoutAlign.sm="start"
                            [ngClass.sm]="'mt-0 ml-16'">
                            <div>
                              <mat-icon aria-hidden="false" aria-label="current project"
                                class="zoom s-20 mr-8 condo-red-text custom-icon">perm_identity</mat-icon>
                              {{message.fromUser.firstName}} {{message.fromUser.lastName}} <span
                                class="ml-8 mr-8">|</span>
                              {{message.fromOrganisation.organisationName}}
                            </div>
                          </div>
                        </div>
                        <div class="condo-gray-text mt-8 line-height-24" fxLayoutAlign.xs="center center"
                          [ngClass.sm]="'text-center'" (click)="openMessageDetailDialog()">{{message.threadDescription}}
                        </div>
                        <div class="condo-gray-text mt-8 line-height-24" fxLayout.xs="column wrap"
                          fxLayoutAlign.xs="center center">
                          <div class="mt-16" fxLayout="row wrap">
                            <span *ngFor="let attachment of message.files"
                              (click)="attachmentClicked($event, attachment)" class="mr-24 mb-16 cursor attachment-icon"
                              style="font-size:11px">{{attachment.fileName}}
                            </span>
                          </div>
                        </div>

                        <div class="" fxLayout="row" fxLayout.sm="column wrap" fxLayout.xs="column wrap"
                          fxLayoutAlign="space-between end" fxLayoutAlign.sm="start start"
                          fxLayoutAlign.xs="space-between center" [ngClass.sm]="'mt-24'" [ngClass.xs]="'mt-20'">
                          <div class="h3 font-weight-600" fxLayout="row">
                            <mat-icon aria-hidden="false" aria-label="current project"
                              class="zoom s-16 mt-4 mr-8 condo-red-text">
                              comment</mat-icon> {{message.comments.length}} Comments
                          </div>
                          <div class="condo-gray-text mt-16" fxLayout="column" fxLayoutAlign.sm="start"
                            [ngClass.sm]="'mt-0 ml-16'">
                            <div>

                              <mat-icon aria-hidden="false" aria-label="current project"
                                class="zoom s-16 condo-red-text">
                                calendar_today</mat-icon>
                              {{message.formatedCreatedDate}}
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>



          </div>
        </div>
      </div>

      <div class="card-footer pb-0 pt-3" fxLayoutAlign="end end" [ngClass.lg]="'mx-24'" [ngClass.md]="'mx-24'"
        [ngClass.sm]="'mx-12'" [ngClass.xs]="'mx-4'">
        <jw-pagination [pageSize]="15" [items]="externalMessages" (changePage)="onChangePage($event)">
        </jw-pagination>
      </div>

    </div>



  </div>
</div>
